#!/usr/bin/env node

const program  = require('commander');

function execHelp(){
	return process.argv.some(function(arg){
		return arg == '-h' || arg == '--help';
	});
}

program.version('0.0.1');

// init command
program
	.command('init [name]')
	.option('-h, --help', '查看init命令帮助', function(){
		console.log('');
		console.log('命令：ymock init [name]')
		console.log('功能：初始化ymock项目, [name]指定项目名称，默认为ymock。');
	})
	.action(function(name){
		if(execHelp()) return;
		var init = require('../commander/init.js');
		init(name);
	});

// run command
program
	.command('run')
	.option('-p, --port [port]', '指定端口号')
	.option('-h, --help', '查看run命令帮助', function(){
		console.log('');
		console.log('命令：ymock run [-p 8080]');
		console.log('功能：启动mock服务');
	})
	.action(function(options){
		if(execHelp()) return;
		
		var mock = require('../commander/run.js');
		mock(options.port);
	});

program.parse(process.argv);

process.on('error', function(error){
	console.log(error);
});